........................................................................ [  5%]
........................................................................ [ 10%]
........................................................................ [ 15%]
........................................................................ [ 20%]
................F....................................................... [ 25%]
........................................................................ [ 30%]
........................................................................ [ 35%]
........................................................................ [ 40%]
..............................s......................................... [ 45%]
........................................................................ [ 50%]
........................................................................ [ 55%]
........................................................................ [ 60%]
........................................................................ [ 66%]
........................................................................ [ 71%]
........................................................................ [ 76%]
........................................................................ [ 81%]
........................................................................ [ 86%]
........................................................................ [ 91%]
........................................................................ [ 96%]
..................................................                       [100%]
=================================== FAILURES ===================================
___________________________ test_write_timeout[trio] ___________________________

agen = <async_generator object ByteStream.__aiter__ at 0x7a77f532b940>

    @_core.enable_ki_protection
    def finalizer(agen: AsyncGeneratorType[object, NoReturn]) -> None:
        try:
            self.foreign.remove(id(agen))
        except KeyError:
            is_ours = True
        else:
            is_ours = False
    
        agen_name = name_asyncgen(agen)
        if is_ours:
            runner.entry_queue.run_sync_soon(
                finalize_in_trio_context,
                agen,
                agen_name,
            )
    
            # Do this last, because it might raise an exception
            # depending on the user's warnings filter. (That
            # exception will be printed to the terminal and
            # ignored, since we're running in GC context.)
>           warnings.warn(
                f"Async generator {agen_name!r} was garbage collected before it "
                "had been exhausted. Surround its use in 'async with "
                "aclosing(...):' to ensure that it gets cleaned up as soon as "
                "you're done using it.",
                ResourceWarning,
                stacklevel=2,
                source=agen,
            )
E           ResourceWarning: Async generator 'httpx._content.ByteStream.__aiter__' was garbage collected before it had been exhausted. Surround its use in 'async with aclosing(...):' to ensure that it gets cleaned up as soon as you're done using it.

../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/trio/_core/_asyncgens.py:122: ResourceWarning

The above exception was the direct cause of the following exception:

cls = <class '_pytest.runner.CallInfo'>
func = <function call_and_report.<locals>.<lambda> at 0x7a77f515d8a0>
when = 'call'
reraise = (<class '_pytest.outcomes.Exit'>, <class 'KeyboardInterrupt'>)

    @classmethod
    def from_call(
        cls,
        func: Callable[[], TResult],
        when: Literal["collect", "setup", "call", "teardown"],
        reraise: type[BaseException] | tuple[type[BaseException], ...] | None = None,
    ) -> CallInfo[TResult]:
        """Call func, wrapping the result in a CallInfo.
    
        :param func:
            The function to call. Called without arguments.
        :type func: Callable[[], _pytest.runner.TResult]
        :param when:
            The phase in which the function is called.
        :param reraise:
            Exception or exceptions that shall propagate if raised by the
            function, instead of being wrapped in the CallInfo.
        """
        excinfo = None
        instant = timing.Instant()
        try:
>           result: TResult | None = func()
                                     ^^^^^^

../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/runner.py:353: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/runner.py:245: in <lambda>
    lambda: runtest_hook(item=item, **kwds),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/pluggy/_hooks.py:512: in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/pluggy/_manager.py:120: in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/logging.py:850: in pytest_runtest_call
    yield
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/capture.py:900: in pytest_runtest_call
    return (yield)
            ^^^^^
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/skipping.py:268: in pytest_runtest_call
    return (yield)
            ^^^^^
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/unraisableexception.py:158: in pytest_runtest_call
    collect_unraisable(item.config)
../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/unraisableexception.py:79: in collect_unraisable
    raise errors[0]
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

config = <_pytest.config.Config object at 0x7a77f7eb0b30>

    def collect_unraisable(config: Config) -> None:
        pop_unraisable = config.stash[unraisable_exceptions].pop
        errors: list[pytest.PytestUnraisableExceptionWarning | RuntimeError] = []
        meta = None
        hook_error = None
        try:
            while True:
                try:
                    meta = pop_unraisable()
                except IndexError:
                    break
    
                if isinstance(meta, BaseException):
                    hook_error = RuntimeError("Failed to process unraisable exception")
                    hook_error.__cause__ = meta
                    errors.append(hook_error)
                    continue
    
                msg = meta.msg
                try:
>                   warnings.warn(pytest.PytestUnraisableExceptionWarning(msg))
E                   pytest.PytestUnraisableExceptionWarning: Exception ignored in: <async_generator object ByteStream.__aiter__ at 0x7a77f532b940>
E                   Enable tracemalloc to get traceback where the object was allocated.
E                   See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

../../flaky-tests-comparative-study/.venv-httpx/lib/python3.12/site-packages/_pytest/unraisableexception.py:67: PytestUnraisableExceptionWarning
----------------------------- Captured stdout call -----------------------------
INFO:     127.0.0.1:50692 - "PUT /slow_response HTTP/1.1" 200 OK
=========================== short test summary info ============================
SKIPPED [1] tests/client/test_auth.py:273: netrc files without a password are valid from Python >= 3.11
1 failed, 1416 passed, 1 skipped in 11.30s
